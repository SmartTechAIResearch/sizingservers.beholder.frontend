var endpoint="http://localhost:5000/api/list?apiKey=<insert a SHA-512 of a piece of text here>",systemInformations=[],newSystemInformationsCount=0,collapsed=!0,template='<div class="si" id="si{{}}"><div class="siHeader"><button class="btn" id="siToggleCollapse{{}}">></button>&nbsp;<label id="siHostname{{}}"></label>&nbsp;<span id="siIPs{{}}"></span><span id="siTimestamp{{}}"></span></div><div class="siBody" id="siBody{{}}"><ul><li id="siOS{{}}"></li><li id="siSystem{{}}"> </li><li id="siBaseboard{{}}"> </li><li id="siBios{{}}"> </li><li id="siProcessors{{}}"> </li><li id="siMemoryModules{{}}"></li><li id="siDisks{{}}"> </li><li id="siNics{{}}"> </li></ul></div></div>',systemInformation=function(s){var t,e=this;++newSystemInformationsCount;var n="#siToggleCollapse"+newSystemInformationsCount,o="#siHostname"+newSystemInformationsCount,i="#siIPs"+newSystemInformationsCount,a="#siTimestamp"+newSystemInformationsCount,l="#siBody"+newSystemInformationsCount,r="#siOS"+newSystemInformationsCount,m="#siSystem"+newSystemInformationsCount,c="#siBaseboard"+newSystemInformationsCount,u="#siBios"+newSystemInformationsCount,d="#siProcessors"+newSystemInformationsCount,f="#siMemoryModules"+newSystemInformationsCount,p="#siDisks"+newSystemInformationsCount,y="#siNics"+newSystemInformationsCount;$("#container").append(template.replace(/{{}}/g,newSystemInformationsCount)),this.updateInfo=function(s){t=s.hostname,$(o).text(t),$(i).text(s.ips.replace(/\t/g,", "));var e=s.timeStampInSecondsSinceEpochUtc;e<1e10&&(e*=1e3),e=new Date(e+(new Date).getTimezoneOffset()*-1),$(a).text("(last updated: "+e+")"),$(r).text("OS: "+s.os),$(m).text("System: "+s.system),$(c).text("Baseboard: "+s.baseboard),$(u).text("BIOS: "+s.bios),$(d).text("Processors: "+s.processors.replace(/\t/g,", ")),$(f).text("Memory modules: "+s.memoryModules.replace(/\t/g,",")),$(p).text("Disks: "+s.disks.replace(/\t/g,", ")),$(y).text("NICs: "+s.nics.replace(/\t/g,", "))},this.hostname=function(){return t},this.collapsed=function(){return!$(l).is(":visible")},this.collapse=function(){$(l).hide(),$(n).text(">")},this.uncollapse=function(){$(l).show(),$(n).text("V")},$(n).click(function(){$(l).is(":visible")?e.collapse():e.uncollapse()}),this.collapse(),this.updateInfo(s)},refresh=function(){$.getJSON(endpoint,function(s){$.each(s,function(s,t){addOrUpdateSystemInformation(t)})}).always(function(){sortSystemInformationByHostname()})},addOrUpdateSystemInformation=function(s){var t=null;$.each(systemInformations,function(e,n){if(n.hostname()==s.hostname)return t=n,t.updateInfo(s),!1}),null==t&&systemInformations.push(new systemInformation(s))},sortSystemInformationByHostname=function(){var s=$("#container").children();s.sort(function(s,t){var e=s.getAttribute("id").substring("si".length),n=t.getAttribute("id").substring("si".length),o=$("#siHostname"+e).text(),i=$("#siHostname"+n).text();return o>i?1:o<i?-1:0}),s.detach().appendTo($("#container"))},collapse=function(){collapsed=!collapsed;var s=0;$.each(systemInformations,function(t,e){e.collapsed()&&++s}),0==s?collapsed=!0:s==systemInformations.length&&(collapsed=!1),$.each(systemInformations,function(s,t){collapsed?t.collapse():t.uncollapse()})},main=function(){$("#collapse").click(function(){collapse()}),setTimeout(function(){refresh()},1e3),setInterval(function(){refresh()},3e4)};$(document).ready(main);