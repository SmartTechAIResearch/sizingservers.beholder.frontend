var endpoint="http://localhost:5000/systeminformations",apiKey="<insert a SHA-512 of a piece of text here>",systemInformations=[],newSystemInformationsCount=0,collapsed=!0,template='<div class="si" id="si{{}}"><div class="siHeader"><button class="btn" id="siToggleCollapse{{}}">></button>&nbsp;<label id="siHostname{{}}"></label>&nbsp;<span id="siIPs{{}}"></span><span id="siTimestamp{{}}"></span></div><div class="siBody" id="siBody{{}}"><ul><li id="siOS{{}}"></li><li id="siSystem{{}}"> </li><li id="siBaseboard{{}}"> </li><li id="siBios{{}}"> </li><li id="siProcessors{{}}"> </li><li id="siMemoryModules{{}}"></li><li id="siDisks{{}}"> </li><li id="siNics{{}}"> </li></ul><button class="btn btn-default" id="remove{{}}"><img src="img/remove.png" /></button></div></div>',systemInformation=function(t){var s,e=this;++newSystemInformationsCount;var n="#si"+newSystemInformationsCount,o="#siToggleCollapse"+newSystemInformationsCount,i="#siHostname"+newSystemInformationsCount,a="#siIPs"+newSystemInformationsCount,m="#siTimestamp"+newSystemInformationsCount,r="#siBody"+newSystemInformationsCount,l="#siOS"+newSystemInformationsCount,c="#siSystem"+newSystemInformationsCount,u="#siBaseboard"+newSystemInformationsCount,f="#siBios"+newSystemInformationsCount,d="#siProcessors"+newSystemInformationsCount,p="#siMemoryModules"+newSystemInformationsCount,y="#siDisks"+newSystemInformationsCount,I="#siNics"+newSystemInformationsCount,S="#remove"+newSystemInformationsCount;$("#container").append(template.replace(/{{}}/g,newSystemInformationsCount)),this.updateInfo=function(t){s=t.hostname,$(i).text(s),$(a).text(t.ips.replace(/\t/g,", "));var e=t.timeStampInSecondsSinceEpochUtc;e<1e10&&(e*=1e3),e=new Date(e+(new Date).getTimezoneOffset()*-1),$(m).text("(last updated: "+e+")"),$(l).text("OS: "+t.os),$(c).text("System: "+t.system),$(u).text("Baseboard: "+t.baseboard),$(f).text("BIOS: "+t.bios),$(d).text("Processors: "+t.processors.replace(/\t/g,", ")),$(p).text("Memory modules: "+t.memoryModules.replace(/\t/g,",")),$(y).text("Disks: "+t.disks.replace(/\t/g,", ")),$(I).text("NICs: "+t.nics.replace(/\t/g,", "))},this.hostname=function(){return s},this.collapsed=function(){return!$(r).is(":visible")},this.collapse=function(){$(r).hide(),$(o).text(">")},this.uncollapse=function(){$(r).show(),$(o).text("V")},$(o).click(function(){$(r).is(":visible")?e.collapse():e.uncollapse()}),$(S).click(function(){systemInformations=jQuery.grep(systemInformations,function(t){return t!=e}),$(n).remove(),$.ajax({url:endpoint+"/remove?apiKey="+apiKey+"&hostname="+s,type:"DELETE"})}),this.collapse(),this.updateInfo(t)},refresh=function(){$.getJSON(endpoint+"/list?apiKey="+apiKey,function(t){$.each(t,function(t,s){addOrUpdateSystemInformation(s)})}).always(function(){sortSystemInformationByHostname()})},addOrUpdateSystemInformation=function(t){var s=null;$.each(systemInformations,function(e,n){if(n.hostname()==t.hostname)return s=n,s.updateInfo(t),!1}),null==s&&systemInformations.push(new systemInformation(t))},sortSystemInformationByHostname=function(){var t=$("#container").children();t.sort(function(t,s){var e=t.getAttribute("id").substring("si".length),n=s.getAttribute("id").substring("si".length),o=$("#siHostname"+e).text(),i=$("#siHostname"+n).text();return o>i?1:o<i?-1:0}),t.detach().appendTo($("#container"))},collapse=function(){collapsed=!collapsed;var t=0;$.each(systemInformations,function(s,e){e.collapsed()&&++t}),0==t?collapsed=!0:t==systemInformations.length&&(collapsed=!1),$.each(systemInformations,function(t,s){collapsed?s.collapse():s.uncollapse()})},main=function(){$("#collapse").click(function(){collapse()}),setTimeout(function(){refresh()},1e3),setInterval(function(){refresh()},3e4)};$(document).ready(main);