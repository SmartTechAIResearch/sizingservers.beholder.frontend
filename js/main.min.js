var endpoint="http://localhost/BeholderDnfAPI/systeminformations",endpointVMH="http://localhost/BeholderDnfAPI/vmwarehosts",apiKey="<insert a SHA-512 of a piece of text here>",systemInformations=[],newSystemInformationsCount=0,collapsed=!0,templateVHost='<div class="si" id="siVH{{}}"><div class="siVHHeader"><button class="btn" id="siVHToggleCollapse{{}}">></button>&nbsp;<label id="siVHIpOrHostname{{}}"></label>&nbsp;<span id="siVHTimestamp{{}}"></span></div><div class="siBody" id="siVHBody{{}}"><ul><li id="siVHOS{{}}"></li><li id="siVHSystem{{}}"> </li><li id="siVHBios{{}}"> </li><li id="siVHProcessors{{}}"> </li><li id="siVHNumCpuCores{{}}"> </li><li id="siVHNumCpuThreads{{}}"> </li><li id="siVHMemoryInGB{{}}"></li><li id="siVHDatastores{{}}"></li><li id="siVHDiskPaths{{}}"> </li><li id="siVHNics{{}}"> </li></ul><button class="btn btn-default" id="vhEdit{{}}">...</button><button class="btn btn-default" id="vhRemove{{}}"><img src="img/remove.png" /></button></div></div>',templateVM='<div class="si" id="si{{}}"><div class="siHeader"><button class="btn" id="siToggleCollapse{{}}">></button>&nbsp;<label id="siHostname{{}}"></label>&nbsp;<span id="siIPs{{}}"></span><span id="siTimestamp{{}}"></span></div><div class="siBody" id="siBody{{}}"><ul><li id="siOS{{}}"></li><li id="siSystem{{}}"> </li><li id="siBaseboard{{}}"> </li><li id="siBios{{}}"> </li><li id="siProcessors{{}}"> </li><li id="siMemoryModules{{}}"></li><li id="siDisks{{}}"> </li><li id="siNics{{}}"> </li></ul><button class="btn btn-default" id="remove{{}}"><img src="img/remove.png" /></button></div></div>',vhSystemInformation=function(s){var t,e=this;siVHNumCpuCores,++newSystemInformationsCount;$("#container").append(templateVHost.replace(/{{}}/g,newSystemInformationsCount)),this.updateInfo=function(s){t=s.hostname,$(_siHostname).text(t),$(_siIPs).text(s.ips.replace(/\t/g,", "));var e=s.timeStampInSecondsSinceEpochUtc;e<1e10&&(e*=1e3),e=new Date(e+(new Date).getTimezoneOffset()*-1),$(_siTimestamp).text("(last updated: "+e+")"),$(_siOS).text("OS: "+s.os),$(_siSystem).text("System: "+s.system),$(_siBaseboard).text("Baseboard: "+s.baseboard),$(_siBios).text("BIOS: "+s.bios),$(_siProcessors).text("Processors: "+s.processors.replace(/\t/g,", ")),$(_siMemoryModules).text("Memory modules: "+s.memoryModules.replace(/\t/g,",")),$(_siDisks).text("Disks: "+s.disks.replace(/\t/g,", ")),$(_siNics).text("NICs: "+s.nics.replace(/\t/g,", "))},this.hostname=function(){return t},this.collapsed=function(){return!$(_siBody).is(":visible")},this.collapse=function(){$(_siBody).hide(),$(_siToggleCollapse).text(">")},this.uncollapse=function(){$(_siBody).show(),$(_siToggleCollapse).text("V")},$(_siToggleCollapse).click(function(){$(_siBody).is(":visible")?e.collapse():e.uncollapse()}),$(_btnRemove).click(function(){systemInformations=jQuery.grep(systemInformations,function(s){return s!=e}),$(_si).remove(),$.ajax({url:endpoint+"/remove?apiKey="+apiKey+"&hostname="+t,type:"DELETE"})}),this.collapse()},systemInformation=function(s){var t,e=this;++newSystemInformationsCount;var i="#si"+newSystemInformationsCount,n="#siToggleCollapse"+newSystemInformationsCount,o="#siHostname"+newSystemInformationsCount,a="#siIPs"+newSystemInformationsCount,l="#siTimestamp"+newSystemInformationsCount,r="#siBody"+newSystemInformationsCount,m="#siOS"+newSystemInformationsCount,c="#siSystem"+newSystemInformationsCount,d="#siBaseboard"+newSystemInformationsCount,u="#siBios"+newSystemInformationsCount,p="#siProcessors"+newSystemInformationsCount,f="#siMemoryModules"+newSystemInformationsCount,y="#siDisks"+newSystemInformationsCount,h="#siNics"+newSystemInformationsCount,I="#remove"+newSystemInformationsCount;$("#container").append(templateVM.replace(/{{}}/g,newSystemInformationsCount)),this.updateInfo=function(s){t=s.hostname,$(o).text(t),$(a).text(s.ips.replace(/\t/g,", "));var e=s.timeStampInSecondsSinceEpochUtc;e<1e10&&(e*=1e3),e=new Date(e+(new Date).getTimezoneOffset()*-1),$(l).text("(last updated: "+e+")"),$(m).text("OS: "+s.os),$(c).text("System: "+s.system),$(d).text("Baseboard: "+s.baseboard),$(u).text("BIOS: "+s.bios),$(p).text("Processors: "+s.processors.replace(/\t/g,", ")),$(f).text("Memory modules: "+s.memoryModules.replace(/\t/g,",")),$(y).text("Disks: "+s.disks.replace(/\t/g,", ")),$(h).text("NICs: "+s.nics.replace(/\t/g,", "))},this.hostname=function(){return t},this.collapsed=function(){return!$(r).is(":visible")},this.collapse=function(){$(r).hide(),$(n).text(">")},this.uncollapse=function(){$(r).show(),$(n).text("V")},$(n).click(function(){$(r).is(":visible")?e.collapse():e.uncollapse()}),$(I).click(function(){systemInformations=jQuery.grep(systemInformations,function(s){return s!=e}),$(i).remove(),$.ajax({url:endpoint+"/remove?apiKey="+apiKey+"&hostname="+t,type:"DELETE"})}),this.collapse(),this.updateInfo(s)},refresh=function(){$.getJSON(endpoint+"/list?apiKey="+apiKey,function(s){$.each(s,function(s,t){addOrUpdateSystemInformation(t)})}).always(function(){sortSystemInformationByHostname()})},addOrUpdateSystemInformation=function(s){var t=null;$.each(systemInformations,function(e,i){if(i.hostname()==s.hostname)return t=i,t.updateInfo(s),!1}),null==t&&systemInformations.push(new systemInformation(s))},sortSystemInformationByHostname=function(){var s=$("#container").children();s.sort(function(s,t){var e=s.getAttribute("id").substring("si".length),i=t.getAttribute("id").substring("si".length),n=$("#siHostname"+e).text(),o=$("#siHostname"+i).text();return n>o?1:n<o?-1:0}),s.detach().appendTo($("#container"))},addVMwareHost=function(){vhSystemInformation()},collapse=function(){collapsed=!collapsed;var s=0;$.each(systemInformations,function(t,e){e.collapsed()&&++s}),0==s?collapsed=!0:s==systemInformations.length&&(collapsed=!1),$.each(systemInformations,function(s,t){collapsed?t.collapse():t.uncollapse()})},main=function(){$("#addvhost").click(function(){addVMwareHost()}),$("#collapse").click(function(){collapse()}),setTimeout(function(){refresh()},1e3),setInterval(function(){refresh()},3e4)};$(document).ready(main);